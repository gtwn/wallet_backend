const jwt = require("jsonwebtoken");

module.exports = (req, res, next) => {
  try {
    const token = req.headers.authorization.split(" ")[1];
    const decodedToken = jwt.verify(token, process.env.JWT_KEY);
    req.userData = { email: decodedToken.email, userId: decodedToken.userId };
    next();
  } catch (error) {
    res.status(401).json({ message: "You are not authenticated!" });
  }
};
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uLy4uL3NyYy9taWRkbGV3YXJlL2NoZWNrLWF1dGguanMiXSwibmFtZXMiOlsiand0IiwicmVxdWlyZSIsIm1vZHVsZSIsImV4cG9ydHMiLCJyZXEiLCJyZXMiLCJuZXh0IiwidG9rZW4iLCJoZWFkZXJzIiwiYXV0aG9yaXphdGlvbiIsInNwbGl0IiwiZGVjb2RlZFRva2VuIiwidmVyaWZ5IiwicHJvY2VzcyIsImVudiIsIkpXVF9LRVkiLCJ1c2VyRGF0YSIsImVtYWlsIiwidXNlcklkIiwiZXJyb3IiLCJzdGF0dXMiLCJqc29uIiwibWVzc2FnZSJdLCJtYXBwaW5ncyI6IkFBQUEsTUFBTUEsTUFBTUMsUUFBUSxjQUFSLENBQVo7O0FBRUFDLE9BQU9DLE9BQVAsR0FBaUIsQ0FBQ0MsR0FBRCxFQUFNQyxHQUFOLEVBQVdDLElBQVgsS0FBb0I7QUFDbkMsTUFBSTtBQUNGLFVBQU1DLFFBQVFILElBQUlJLE9BQUosQ0FBWUMsYUFBWixDQUEwQkMsS0FBMUIsQ0FBZ0MsR0FBaEMsRUFBcUMsQ0FBckMsQ0FBZDtBQUNBLFVBQU1DLGVBQWVYLElBQUlZLE1BQUosQ0FBV0wsS0FBWCxFQUFrQk0sUUFBUUMsR0FBUixDQUFZQyxPQUE5QixDQUFyQjtBQUNBWCxRQUFJWSxRQUFKLEdBQWUsRUFBRUMsT0FBT04sYUFBYU0sS0FBdEIsRUFBNkJDLFFBQVFQLGFBQWFPLE1BQWxELEVBQWY7QUFDQVo7QUFDRCxHQUxELENBS0UsT0FBT2EsS0FBUCxFQUFjO0FBQ2RkLFFBQUllLE1BQUosQ0FBVyxHQUFYLEVBQWdCQyxJQUFoQixDQUFxQixFQUFFQyxTQUFTLDRCQUFYLEVBQXJCO0FBQ0Q7QUFDRixDQVREIiwiZmlsZSI6ImNoZWNrLWF1dGguanMiLCJzb3VyY2VzQ29udGVudCI6WyJjb25zdCBqd3QgPSByZXF1aXJlKFwianNvbndlYnRva2VuXCIpO1xyXG5cclxubW9kdWxlLmV4cG9ydHMgPSAocmVxLCByZXMsIG5leHQpID0+IHtcclxuICB0cnkge1xyXG4gICAgY29uc3QgdG9rZW4gPSByZXEuaGVhZGVycy5hdXRob3JpemF0aW9uLnNwbGl0KFwiIFwiKVsxXTtcclxuICAgIGNvbnN0IGRlY29kZWRUb2tlbiA9IGp3dC52ZXJpZnkodG9rZW4sIHByb2Nlc3MuZW52LkpXVF9LRVkpO1xyXG4gICAgcmVxLnVzZXJEYXRhID0geyBlbWFpbDogZGVjb2RlZFRva2VuLmVtYWlsLCB1c2VySWQ6IGRlY29kZWRUb2tlbi51c2VySWQgfTtcclxuICAgIG5leHQoKTtcclxuICB9IGNhdGNoIChlcnJvcikge1xyXG4gICAgcmVzLnN0YXR1cyg0MDEpLmpzb24oeyBtZXNzYWdlOiBcIllvdSBhcmUgbm90IGF1dGhlbnRpY2F0ZWQhXCIgfSk7XHJcbiAgfVxyXG59O1xyXG4iXX0=